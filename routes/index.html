<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="Description" content="simple HTML page for back-end-only eCommSQL"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/4.6.0/darkly/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">
<title>e-Comm SQL</title>
</head>
<body>
<nav class="navbar navbar-expand navbar-light bg-warning text-light fixed-top py-0">
  <a class="navbar-brand" href="https://github.com/attila5287/e-commerce"> 
    <img alt="@attila5287" src="https://avatars1.githubusercontent.com/u/42498753?s=60&amp;u=739973fd70454aa533c67bccf17b6aeddcc6361f&amp;v=4" class="rounded my-0 py-0" 
    width= "36" 
    height="36">
     </a>
  <button class="navbar-toggler" data-target="#my-nav" data-toggle="collapse" aria-controls="my-nav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div id="my-nav" class="collapse navbar-collapse">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link text-light" href="ecommsql.herokuapp.com">
          <h3 class="text-primary">
            <i class="fab fa-amazon text-dark mr-2"></i>
            E-Commerce with SQL
          </h3>
          <span class="sr-only">(current)</span></a>
      </li>
    </ul>
  </div>
</nav>
<hr class="mt-5">
<h1 class="mt-4 text center">Products</h1>
<hr class="border-light mt-0 mb-2">
<div class="card-deck" id="products">
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/js/bootstrap.min.js"></script>

<style>
  .card-img-top {
    max-height: 12rem;
  }

  .rounded-xl {
    border-radius: 1rem;
  }
</style>
<script>
  $.ajax( {
    type: "GET",
    url: '/api/products',
  } ).then((products) => {
    console.log('products :>> ', products);
      products.forEach(p => {
        const col = $('<div>');
        col.attr('class', 'col-sm-4');
          
        const card = $('<div>');
        card.attr('class', 'card mx-2');

        const header = $('<h4>');
        header.attr('class', 'card-header text-center  h-100');
        header.text(p.product_name);  

        const a_icon =  $('<h4>').attr('class', 'fab fa-amazon bg-warning rounded-xl mr-2 p-1 ml-2')  
        header.append(a_icon);    

        const img = $('<img>');
        img.attr('class', 'card-img-top bg-transparent');
        img.attr('src', p.img_url);
        img.text(p.product_name);  

        const body = $('<div>');
        body.attr('class', 'card-footer');
        
        const title = $('<h3>');
        title.attr('class', 'card-title text-center text-dark bg-warning rounded-xl');
        title.text('$ '+p.price+ '.00');  

        const shop_icon =  $('<i>').attr('class', 'fas fa-shopping-cart ml-2')  
        title.append(shop_icon);    
        
        const text = $('<p>');
        text.attr('class', 'card-text text-muted font-italic text-right');
        text.text(p.tags.map(d=>d.tag_name.toUpperCase()).join(', '));  
        
        const tag_icon =  $('<h4>').attr('class', 'fas fa-tag ml-2')  
        text.append(tag_icon);    
        
        body.append(title);    
        body.append(text);

        const footer = $('<div>');
        footer.attr('class', 'card-footer text-center text-warning');
        footer.text(p.category.category_name);  

        const cat_icon =  $('<h4>').attr('class', 'far fa-object-ungroup ml-2')  
        footer.append(cat_icon);    
        
        card.append(header);  
        card.append(img);  
        card.append(body);  
        card.append(footer);  

        // col.append(card);  
        $('#products').append(card);
        
      });

    
  }).catch((err) => {
    console.log('err :>> ', err);
  });
</script>

</body>
</html>
